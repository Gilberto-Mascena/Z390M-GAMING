name: Uploud EFI to Release

on:
  push:
    tags:
      - 'v*'

jobs:
  build:
    runs-on: ubuntu-latest
    permissions:
      contents: write

    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        with:
          fetch-depth: 0 # Necess√°rio para o GitHub conseguir comparar os commits e gerar as notas

      - name: Packaging EFIs
        run: |
          # Compacta cada pasta individualmente
          zip -r "Z390M-GAMING-HIGH-SIERRA.zip" "Z390M-GAMING-HIGH-SIERRA"
          zip -r "Z390M-GAMING-MOJAVE.zip" "Z390M-GAMING-MOJAVE"
          zip -r "Z390M-GAMING-CATALINA-VENTURA.zip" "Z390M-GAMING-CATALINA-VENTURA"
          zip -r "Z390M-GAMING-SONOMA-SEQUOIA.zip" "Z390M-GAMING-SONOMA-SEQUOIA"
          zip -r "Z390M-GAMING-TAHOE.zip" "Z390M-GAMING-TAHOE"

      - name: Upload Release Asset
        uses: softprops/action-gh-release@v2
        with:
          name: EFI Z390M ${{ github.ref_name }}
          body_path: changelog.md
          generate_release_notes: true # Gera o "What's Changed" automaticamente
          draft: false
          prerelease: false
          files: |
            ./*.zip